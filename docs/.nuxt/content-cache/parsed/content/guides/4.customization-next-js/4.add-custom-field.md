{"parsed":{"_path":"/guides/customization-next-js/add-custom-field","_dir":"customization-next-js","_draft":false,"_partial":false,"_locale":"","title":"Adding custom fields","description":"It's a common case to enrich the default data models with custom fields.","layout":"default","navigation":{"icon":"tabler:number-3-small"},"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"adding-custom-fields-to-the-unified-data-model-implementing-available-for-pickup-feature"},"children":[{"type":"text","value":"Adding custom fields to the Unified Data Model / Implementing \"Available for pickup\" feature"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"It's a common case to enrich the default data models with custom fields."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this chapter, you will learn:"}]},{"type":"element","tag":"list","props":{"type":"success"},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"how to add a custom field to the unified product data model in the middleware"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"how to utilize that field in the storefront"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"By adding a \"pickup availability\" feature."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Available for pickup","src":"/guides/4.customization-next-js/images/available-for-pickup.webp","style":{"aspectRatio":"4077/2598"}},"children":[]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Open "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"apps/storefront-middleware/integrations/sapcc/extensions/unified.ts"}]},{"type":"text","value":" file and modify the code accordingly:"}]}]},{"type":"element","tag":"pre","props":{"className":"language-diff shiki shiki-themes one-dark-pro","code":"export const unifiedApiExtension = createUnifiedExtension({\n  normalizers: {\n    addCustomFields: [\n+      {\n+        normalizeProduct(context, input) {\n+          return {\n+            availableForPickup: input.availableForPickup,\n+          };\n+        },\n+      },\n    ],\n  },\n","filename":"apps/storefront-middleware/integrations/sapcc/extensions/unified.ts","language":"diff","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"export const unifiedApiExtension = createUnifiedExtension({\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"  normalizers: {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"    addCustomFields: [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#98C379"},"children":[{"type":"text","value":"+      {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#98C379"},"children":[{"type":"text","value":"+        normalizeProduct(context, input) {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#98C379"},"children":[{"type":"text","value":"+          return {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#98C379"},"children":[{"type":"text","value":"+            availableForPickup: input.availableForPickup,\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#98C379"},"children":[{"type":"text","value":"+          };\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#98C379"},"children":[{"type":"text","value":"+        },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#98C379"},"children":[{"type":"text","value":"+      },\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"    ],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"  },\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Within "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"addCustomFields"}]},{"type":"text","value":", we extend the normalizer functions. We take the raw input (coming from eCommerce) and have to\nreturn a set of custom fields."}]},{"type":"element","tag":"info","props":{},"children":[{"type":"element","tag":"template","props":{"v-slot:title":""},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Read more about normalizers and custom fields here: "},{"type":"element","tag":"a","props":{"href":"https://docs.alokai.com/storefront/unified-data-layer/normalizers","rel":["nofollow"]},"children":[{"type":"text","value":"https://docs.alokai.com/storefront/unified-data-layer/normalizers"}]}]}]},{"type":"element","tag":"ol","props":{"start":2},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Now, "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"availableForPickup"}]},{"type":"text","value":" field should be available in the front end, so let's use it. Replace the hardcoded placeholder\nin the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"PurchaseCard"}]},{"type":"text","value":" component:"}]}]},{"type":"element","tag":"pre","props":{"className":"language-diff shiki shiki-themes one-dark-pro","code":"-  <Trans ns=\"product\" i18nKey=\"additionalInfo.pickup\">\n-    Pickup not available at Super center.&nbsp;\n-    <SfLink href=\"#\" variant=\"secondary\">\n-      Check availability nearby\n-    </SfLink>\n-  </Trans>\n+  <p>Pickup {product.$custom?.availableForPickup ? '' : 'not'} available</p>\n","filename":"storefront-unified-nextjs/components/PurchaseCard/PurchaseCard.tsx","language":"diff","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E06C75"},"children":[{"type":"text","value":"-  <Trans ns=\"product\" i18nKey=\"additionalInfo.pickup\">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E06C75"},"children":[{"type":"text","value":"-    Pickup not available at Super center.&nbsp;\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E06C75"},"children":[{"type":"text","value":"-    <SfLink href=\"#\" variant=\"secondary\">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E06C75"},"children":[{"type":"text","value":"-      Check availability nearby\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E06C75"},"children":[{"type":"text","value":"-    </SfLink>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E06C75"},"children":[{"type":"text","value":"-  </Trans>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#98C379"},"children":[{"type":"text","value":"+  <p>Pickup {product.$custom?.availableForPickup ? '' : 'not'} available</p>\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"And that's it. You can find a complete project example in this repository: "},{"type":"element","tag":"a","props":{"href":"https://github.com/vsf-customer/extensibility-demo","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/vsf-customer/extensibility-demo"}]},{"type":"text","value":"\nIf you want to get access to it, contact our "},{"type":"element","tag":"a","props":{"href":"https://docs.alokai.com/enterprise","rel":["nofollow"]},"children":[{"type":"text","value":"sales team"}]},{"type":"text","value":"."}]},{"type":"element","tag":"card","props":{"icon":"tabler:number-4-small","title":"Next: Change product slug"},"children":[{"type":"element","tag":"template","props":{"v-slot:description":""},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Learn how to override normalizers."}]}]},{"type":"element","tag":"template","props":{"v-slot:cta":""},"children":[{"type":"element","tag":"docs-button","props":{"to":"/guides/customization-next-js/changing-product-slug"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Next"}]}]}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":5,"depth":2,"links":[]}},"_type":"markdown","_id":"content:guides:4.customization-next-js:4.add-custom-field.md","_source":"content","_file":"guides/4.customization-next-js/4.add-custom-field.md","_extension":"md","sitemap":{"loc":"/guides/customization-next-js/add-custom-field"}},"hash":"1S2ehiHIIz"}