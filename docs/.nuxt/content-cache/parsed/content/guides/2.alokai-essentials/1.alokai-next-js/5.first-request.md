{"parsed":{"_path":"/guides/alokai-essentials/alokai-next-js/first-request","_dir":"alokai-next-js","_draft":false,"_partial":false,"_locale":"","title":"First request","description":"In the previous sections, we have successfully installed and configured Alokai Connect. Now, it is time to learn how the data is flowing in the application. For a deep dive in the Alokai architecture, please refer to the Architecure Overview. In this guide, we will focus on a high-level overview of the data flow in the Alokai Connect.","layout":"default","navigation":{"icon":"tabler:number-4-small"},"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"first-request-with-alokai-connect"},"children":[{"type":"text","value":"First request with Alokai Connect"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In the previous sections, we have successfully installed and configured Alokai Connect. Now, it is time to learn how the data is flowing in the application. For a deep dive in the Alokai architecture, please refer to the "},{"type":"element","tag":"a","props":{"href":"/general/basics/architecture"},"children":[{"type":"text","value":"Architecure Overview"}]},{"type":"text","value":". In this guide, we will focus on a high-level overview of the data flow in the Alokai Connect."}]},{"type":"element","tag":"h2","props":{"id":"data-flow"},"children":[{"type":"text","value":"Data flow"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Right now, we can visualize our application as shown in the diagram below:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Alokai Application","src":"/guides/2.alokai-essentials/1.alokai-next-js/images/alokai-app-1.webp","style":{"aspectRatio":"2800/647"}},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The Storefront is a Next.js application located in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"apps/storefront"}]},{"type":"text","value":". It is responsible for rendering the UI and handling the user interactions. The Storefront is using the Alokai SDK to communicate with Alokai Middleware. The Alokai Middleware is an Express.js application located in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"apps/middleware"}]},{"type":"text","value":". It is responsible for handling the requests from the Storefront and communicating with the SAP Commerce Cloud."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The data flow is as follows:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The Storefront uses SDK methods to request data from the Alokai Middleware."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The Alokai Middleware handles the request and communicates with the SAP Commerce Cloud."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The SAP Commerce Cloud returns the requested data to the Alokai Middleware."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The Alokai Middleware returns the data to the Storefront."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Look at the diagram below to visualize the data flow:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Alokai Data Flow","src":"/guides/2.alokai-essentials/1.alokai-next-js/images/alokai-app-2.webp","style":{"aspectRatio":"2800/647"}},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Having a high-level overview of the data flow, we can now proceed to the next section to make our first request to the SAP Commerce Cloud."}]},{"type":"element","tag":"h2","props":{"id":"first-request"},"children":[{"type":"text","value":"First request"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To create your first request, let's use the existing "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"storefront/app/page.tsx"}]},{"type":"text","value":" file. We will use "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"searchProduct"}]},{"type":"text","value":" SDK method to get the list of products from the SAP Commerce Cloud. For this example, we will utilize Next.js React Server Components to fetch the data on the server side."}]},{"type":"element","tag":"pre","props":{"className":"language-tsx shiki shiki-themes one-dark-pro","code":"import { getSdk } from \"../sdk/sdk.config\"\n\nconst sdk = getSdk();\n\nexport default async function Page() {\n  const { products } = await sdk.sapcc.searchProduct({});\n\n  console.log(products?.map((product) => product.name));\n\n  return <div>Page</div>\n}\n","language":"tsx","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C678DD"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E06C75"},"children":[{"type":"text","value":"getSdk"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":" } "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C678DD"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#98C379"},"children":[{"type":"text","value":" \"../sdk/sdk.config\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C678DD"},"children":[{"type":"text","value":"const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E5C07B"},"children":[{"type":"text","value":" sdk"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#56B6C2"},"children":[{"type":"text","value":" ="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#61AFEF"},"children":[{"type":"text","value":" getSdk"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"();\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C678DD"},"children":[{"type":"text","value":"export"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C678DD"},"children":[{"type":"text","value":" default"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C678DD"},"children":[{"type":"text","value":" async"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C678DD"},"children":[{"type":"text","value":" function"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#61AFEF"},"children":[{"type":"text","value":" Page"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"() {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C678DD"},"children":[{"type":"text","value":"  const"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":" { "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E5C07B"},"children":[{"type":"text","value":"products"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":" } "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#56B6C2"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C678DD"},"children":[{"type":"text","value":" await"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E5C07B"},"children":[{"type":"text","value":" sdk"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E5C07B"},"children":[{"type":"text","value":"sapcc"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#61AFEF"},"children":[{"type":"text","value":"searchProduct"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"({});\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#E5C07B"},"children":[{"type":"text","value":"  console"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#61AFEF"},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E5C07B"},"children":[{"type":"text","value":"products"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"?."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#61AFEF"},"children":[{"type":"text","value":"map"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"(("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E06C75;--shiki-default-font-style:italic"},"children":[{"type":"text","value":"product"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C678DD"},"children":[{"type":"text","value":"=>"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E5C07B"},"children":[{"type":"text","value":" product"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E06C75"},"children":[{"type":"text","value":"name"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"));\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C678DD"},"children":[{"type":"text","value":"  return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":" <"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E06C75"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":">Page</"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#E06C75"},"children":[{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#ABB2BF"},"children":[{"type":"text","value":"}\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In the code above, we are using Alokai SDK "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"serachProduct"}]},{"type":"text","value":" method to send a request to Alokai Middleware on "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/searchProduct"}]},{"type":"text","value":" endpoint. Middleware then sends a necessary request to SAP Commerce Cloud and returns response back to Storefront."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To run the application, execute the following command:"}]},{"type":"element","tag":"pre","props":{"className":"language-bash shiki shiki-themes one-dark-pro","code":"npm run dev\n","language":"bash","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#61AFEF"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#98C379"},"children":[{"type":"text","value":" run"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#98C379"},"children":[{"type":"text","value":" dev\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Navigate to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://localhost:3000"}]},{"type":"text","value":" in your browser. You should see the list of product names in the console."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"First Request","src":"/guides/2.alokai-essentials/1.alokai-next-js/images/alokai-app-3.webp","style":{"aspectRatio":"2400/1942"}},"children":[]}]},{"type":"element","tag":"info","props":{},"children":[{"type":"element","tag":"template","props":{"v-slot:title":""},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You can find complete implementation in the "},{"type":"element","tag":"a","props":{"href":"https://github.com/vuestorefront-community/nextjs-starter/tree/first-request","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"first-request"}]},{"type":"text","value":" branch"}]}]}]},{"type":"element","tag":"h2","props":{"id":"summary"},"children":[{"type":"text","value":"Summary"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this guide we have successfully utilized Alokai Connect to create our first request to get data from SAP Commerce Cloud in Alokai Next.js application. We also got a better understanding of data flow and how to use SDK and Middleware to fetch data."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In the next section, we will learn how to build UI with Storefront UI - Alokai UI components library for eCommerce applications."}]},{"type":"element","tag":"card","props":{"icon":"tabler:number-5-small","title":"Next: Build Product Details page with Storefront UI"},"children":[{"type":"element","tag":"template","props":{"v-slot:description":""},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Learn how to build responsive and accessible UI with Storefront UI components."}]}]},{"type":"element","tag":"template","props":{"v-slot:cta":""},"children":[{"type":"element","tag":"docs-button","props":{"to":"/guides/alokai-essentials/alokai-next-js/product-page"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Next"}]}]}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":5,"depth":2,"links":[{"id":"data-flow","depth":2,"text":"Data flow"},{"id":"first-request","depth":2,"text":"First request"},{"id":"summary","depth":2,"text":"Summary"}]}},"_type":"markdown","_id":"content:guides:2.alokai-essentials:1.alokai-next-js:5.first-request.md","_source":"content","_file":"guides/2.alokai-essentials/1.alokai-next-js/5.first-request.md","_extension":"md","sitemap":{"loc":"/guides/alokai-essentials/alokai-next-js/first-request"}},"hash":"EzfPpp8bkT"}